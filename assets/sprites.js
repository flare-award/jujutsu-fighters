// assets/sprites.js
const Sprites = {
    // Размеры спрайтов
    FRAME_WIDTH: 32,
    FRAME_HEIGHT: 64,
    SCALE: 2.5, // Увеличение для хорошей видимости
    
    // Спрайты Юджи Итадори (Young)
    yuji_young: {
        idle: [
            [0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0],
            [0,0,0,0,1,2,2,2,2,1,0,0,0,0,0,0],
            [0,0,0,1,2,2,2,2,2,2,1,0,0,0,0,0],
            [0,0,1,2,2,1,2,2,1,2,2,1,0,0,0,0],
            [0,1,2,2,2,2,2,2,2,2,2,2,1,0,0,0],
            [0,1,2,2,2,2,2,2,2,2,2,2,1,0,0,0],
            [0,0,1,2,2,2,2,2,2,2,2,1,0,0,0,0],
            [0,0,0,1,2,2,2,2,2,2,1,0,0,0,0,0],
            [0,0,0,0,1,2,2,2,2,1,0,0,0,0,0,0],
            [0,0,0,0,1,2,2,2,2,1,0,0,0,0,0,0],
            [0,0,0,1,2,2,1,1,2,2,1,0,0,0,0,0],
            [0,0,1,2,2,1,0,0,1,2,2,1,0,0,0,0],
            [0,1,2,2,1,0,0,0,0,1,2,2,1,0,0,0],
            [1,2,2,1,0,0,0,0,0,0,1,2,2,1,0,0],
            [1,2,2,1,0,0,0,0,0,0,1,2,2,1,0,0],
            [0,1,1,0,0,0,0,0,0,0,0,1,1,0,0,0]
        ],
        walk1: [
            [0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0],
            [0,0,0,0,1,2,2,2,2,1,0,0,0,0,0,0],
            [0,0,0,1,2,2,2,2,2,2,1,0,0,0,0,0],
            [0,0,1,2,2,1,2,2,1,2,2,1,0,0,0,0],
            [0,1,2,2,2,2,2,2,2,2,2,2,1,0,0,0],
            [0,1,2,2,2,2,2,2,2,2,2,2,1,0,0,0],
            [0,0,1,2,2,2,2,2,2,2,2,1,0,0,0,0],
            [0,0,0,1,2,2,2,2,2,2,1,0,0,0,0,0],
            [0,0,0,0,1,2,2,2,2,1,0,0,0,0,0,0],
            [0,0,0,0,1,2,2,2,2,1,0,0,0,0,0,0],
            [0,0,0,1,2,2,1,1,2,2,1,0,0,0,0,0],
            [0,0,1,2,2,1,0,0,1,2,2,1,0,0,0,0],
            [0,1,2,2,1,0,0,0,0,1,2,2,1,0,0,0],
            [1,2,2,1,0,0,0,0,0,0,1,2,2,1,0,0],
            [1,2,2,1,0,0,0,0,0,0,1,2,2,1,0,0],
            [0,1,1,0,0,0,0,0,0,0,0,1,1,0,0,0]
        ],
        walk2: [
            [0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0],
            [0,0,0,0,1,2,2,2,2,1,0,0,0,0,0,0],
            [0,0,0,1,2,2,2,2,2,2,1,0,0,0,0,0],
            [0,0,1,2,2,1,2,2,1,2,2,1,0,0,0,0],
            [0,1,2,2,2,2,2,2,2,2,2,2,1,0,0,0],
            [0,1,2,2,2,2,2,2,2,2,2,2,1,0,0,0],
            [0,0,1,2,2,2,2,2,2,2,2,1,0,0,0,0],
            [0,0,0,1,2,2,2,2,2,2,1,0,0,0,0,0],
            [0,0,0,0,1,2,2,2,2,1,0,0,0,0,0,0],
            [0,0,0,1,2,2,2,2,1,0,0,0,0,0,0,0],
            [0,0,1,2,2,1,1,2,2,1,0,0,0,0,0,0],
            [0,1,2,2,1,0,0,1,2,2,1,0,0,0,0,0],
            [1,2,2,1,0,0,0,0,1,2,2,1,0,0,0,0],
            [1,2,2,1,0,0,0,0,0,1,2,2,1,0,0,0],
            [0,1,1,0,0,0,0,0,0,1,2,2,1,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0]
        ],
        attack: [
            [0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0],
            [0,0,0,0,1,2,2,2,2,1,0,0,0,0,0,0,0,0,0,0],
            [0,0,0,1,2,2,2,2,2,2,1,0,0,0,0,0,0,0,0,0],
            [0,0,1,2,2,1,2,2,1,2,2,1,0,0,0,0,0,0,0,0],
            [0,1,2,2,2,2,2,2,2,2,2,2,1,0,0,0,0,0,0,0],
            [0,1,2,2,2,2,2,2,2,2,2,2,1,0,0,0,0,0,0,0],
            [0,0,1,2,2,2,2,2,2,2,2,1,0,0,0,0,0,0,0,0],
            [0,0,0,1,2,2,2,2,2,2,1,0,0,0,0,0,0,0,0,0],
            [0,0,0,0,1,2,2,2,2,1,0,0,0,0,0,0,0,0,0,0],
            [0,0,0,0,1,2,2,2,2,1,0,0,0,0,0,0,0,0,0,0],
            [0,0,0,1,2,2,1,1,2,2,1,0,0,0,0,0,0,0,0,0],
            [0,0,1,2,2,1,0,0,1,2,2,1,0,0,0,0,0,0,0,0],
            [0,1,2,2,1,0,0,0,0,1,2,2,1,0,0,0,3,3,3,3],
            [1,2,2,1,0,0,0,0,0,0,1,2,2,1,0,3,3,3,3,3],
            [1,2,2,1,0,0,0,0,0,0,1,2,2,1,3,3,3,3,3,3],
            [0,1,1,0,0,0,0,0,0,0,0,1,1,0,3,3,3,3,3,3]
        ],
        hurt: [
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0],
            [0,0,0,0,1,2,2,2,2,1,0,0,0,0,0,0],
            [0,0,0,1,2,2,1,1,2,2,1,0,0,0,0,0],
            [0,0,1,2,2,1,0,0,1,2,2,1,0,0,0,0],
            [0,1,2,2,1,0,0,0,0,1,2,2,1,0,0,0],
            [0,1,2,2,1,0,0,0,0,1,2,2,1,0,0,0],
            [0,0,1,1,0,0,0,0,0,0,1,1,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
        ],
        jump: [
            [0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0],
            [0,0,0,0,1,2,2,2,2,1,0,0,0,0,0,0],
            [0,0,0,1,2,2,2,2,2,2,1,0,0,0,0,0],
            [0,0,1,2,2,1,2,2,1,2,2,1,0,0,0,0],
            [0,1,2,2,2,2,2,2,2,2,2,2,1,0,0,0],
            [0,1,2,2,2,2,2,2,2,2,2,2,1,0,0,0],
            [0,0,1,2,2,2,2,2,2,2,2,1,0,0,0,0],
            [0,0,0,1,2,2,2,2,2,2,1,0,0,0,0,0],
            [0,0,0,0,1,2,2,2,2,1,0,0,0,0,0,0],
            [0,0,0,0,1,2,2,2,2,1,0,0,0,0,0,0],
            [0,0,0,1,2,2,1,1,2,2,1,0,0,0,0,0],
            [0,0,1,2,2,1,0,0,1,2,2,1,0,0,0,0],
            [0,1,2,2,1,0,0,0,0,1,2,2,1,0,0,0],
            [1,2,2,1,0,0,0,0,0,0,1,2,2,1,0,0],
            [1,2,2,1,0,0,0,0,0,0,1,2,2,1,0,0],
            [0,1,1,0,0,0,0,0,0,0,0,1,1,0,0,0]
        ],
        block: [
            [0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,4,4,4,4],
            [0,0,0,0,1,2,2,2,2,1,0,0,0,0,0,4,4,4,4,4],
            [0,0,0,1,2,2,2,2,2,2,1,0,0,0,4,4,4,4,4,4],
            [0,0,1,2,2,1,2,2,1,2,2,1,0,4,4,4,4,4,4,4],
            [0,1,2,2,2,2,2,2,2,2,2,2,1,4,4,4,4,4,4,4],
            [0,1,2,2,2,2,2,2,2,2,2,2,1,4,4,4,4,4,4,4],
            [0,0,1,2,2,2,2,2,2,2,2,1,4,4,4,4,4,4,4,4],
            [0,0,0,1,2,2,2,2,2,2,1,4,4,4,4,4,4,4,4,4],
            [0,0,0,0,1,2,2,2,2,1,4,4,4,4,4,4,4,4,4,4],
            [0,0,0,0,1,2,2,2,2,1,4,4,4,4,4,4,4,4,4,4],
            [0,0,0,1,2,2,1,1,2,2,1,4,4,4,4,4,4,4,4,4],
            [0,0,1,2,2,1,0,0,1,2,2,1,4,4,4,4,4,4,4,4],
            [0,1,2,2,1,0,0,0,0,1,2,2,1,4,4,4,4,4,4,4],
            [1,2,2,1,0,0,0,0,0,0,1,2,2,1,4,4,4,4,4,4],
            [1,2,2,1,0,0,0,0,0,0,1,2,2,1,4,4,4,4,4,4],
            [0,1,1,0,0,0,0,0,0,0,0,1,1,0,4,4,4,4,4,4]
        ],
        // Палитра цветов: 0-прозрачный, 1-темный, 2-кожа, 3-атака, 4-блок
        palette: [
            'rgba(0,0,0,0)',      // 0: прозрачный
            '#1a0b0b',            // 1: темный (волосы/очертания)
            '#ff9966',            // 2: кожа
            '#ff3333',            // 3: красный (эффект атаки)
            '#00ffff'             // 4: голубой (эффект блока)
        ]
    },

    // Спрайты Сатору Годжо
    gojo: {
        idle: [
            [0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0],
            [0,0,0,0,1,5,5,5,5,1,0,0,0,0,0,0],
            [0,0,0,1,5,5,5,5,5,5,1,0,0,0,0,0],
            [0,0,1,5,5,1,5,5,1,5,5,1,0,0,0,0],
            [0,1,5,5,5,5,5,5,5,5,5,5,1,0,0,0],
            [0,1,5,5,5,5,5,5,5,5,5,5,1,0,0,0],
            [0,0,1,5,5,5,5,5,5,5,5,1,0,0,0,0],
            [0,0,0,1,5,5,5,5,5,5,1,0,0,0,0,0],
            [0,0,0,0,1,5,5,5,5,1,0,0,0,0,0,0],
            [0,0,0,0,1,5,5,5,5,1,0,0,0,0,0,0],
            [0,0,0,1,5,5,1,1,5,5,1,0,0,0,0,0],
            [0,0,1,5,5,1,6,6,1,5,5,1,0,0,0,0],
            [0,1,5,5,1,6,6,6,6,1,5,5,1,0,0,0],
            [1,5,5,1,6,6,6,6,6,6,1,5,5,1,0,0],
            [1,5,5,1,6,6,6,6,6,6,1,5,5,1,0,0],
            [0,1,1,0,6,6,6,6,6,6,0,1,1,0,0,0]
        ],
        palette: [
            'rgba(0,0,0,0)',      // 0: прозрачный
            '#000033',            // 1: темно-синий
            '#ffffff',            // 2: белый (кожа)
            '#66ccff',            // 3: голубой
            '#0066ff',            // 4: синий
            '#cceeff',            // 5: светлый голубой (волосы)
            '#000066'             // 6: темно-синие глаза
        ]
    },

    // Спрайты Сукуны
    sukuna: {
        idle: [
            [0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0],
            [0,0,0,0,1,7,7,7,7,1,0,0,0,0,0,0],
            [0,0,0,1,7,7,7,7,7,7,1,0,0,0,0,0],
            [0,0,1,7,7,1,7,7,1,7,7,1,0,0,0,0],
            [0,1,7,7,7,7,7,7,7,7,7,7,1,0,0,0],
            [0,1,7,7,7,7,7,7,7,7,7,7,1,0,0,0],
            [0,0,1,7,7,7,7,7,7,7,7,1,0,0,0,0],
            [0,0,0,1,7,7,7,7,7,7,1,0,0,0,0,0],
            [0,0,0,0,1,7,7,7,7,1,0,0,0,0,0,0],
            [0,0,0,0,1,7,7,7,7,1,0,0,0,0,0,0],
            [0,0,0,1,7,7,1,1,7,7,1,0,0,0,0,0],
            [0,0,1,7,7,1,8,8,1,7,7,1,0,0,0,0],
            [0,1,7,7,1,8,0,0,8,1,7,7,1,0,0,0],
            [1,7,7,1,8,0,8,8,0,8,1,7,7,1,0,0],
            [1,7,7,1,8,8,0,0,8,8,1,7,7,1,0,0],
            [0,1,1,0,8,8,8,8,8,8,0,1,1,0,0,0]
        ],
        palette: [
            'rgba(0,0,0,0)',      // 0: прозрачный
            '#000000',            // 1: черный
            '#663300',            // 2: кожа
            '#ff0000',            // 3: красный
            '#990000',            // 4: темно-красный
            '#ff6600',            // 5: оранжевый
            '#cc3300',            // 6: красно-оранжевый
            '#ff3333',            // 7: красный (волосы Сукуны)
            '#000000'             // 8: черные отметины
        ]
    },

    // Эффекты способностей
    effects: {
        divergent_fist: [
            [0,0,0,0,0,3,3,3,3,0,0,0,0,0],
            [0,0,0,3,3,3,3,3,3,3,3,0,0,0],
            [0,0,3,3,3,3,3,3,3,3,3,3,0,0],
            [0,3,3,3,3,3,3,3,3,3,3,3,3,0],
            [0,3,3,3,3,3,3,3,3,3,3,3,3,0],
            [3,3,3,3,3,3,3,3,3,3,3,3,3,3],
            [3,3,3,3,3,3,3,3,3,3,3,3,3,3],
            [3,3,3,3,3,3,3,3,3,3,3,3,3,3],
            [3,3,3,3,3,3,3,3,3,3,3,3,3,3],
            [0,3,3,3,3,3,3,3,3,3,3,3,3,0],
            [0,3,3,3,3,3,3,3,3,3,3,3,3,0],
            [0,0,3,3,3,3,3,3,3,3,3,3,0,0],
            [0,0,0,3,3,3,3,3,3,3,3,0,0,0],
            [0,0,0,0,0,3,3,3,3,0,0,0,0,0]
        ],
        
        black_flash: [
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,9,9,9,9,9,0,0,0,0,0,0],
            [0,0,0,0,9,9,9,9,9,9,9,0,0,0,0,0],
            [0,0,0,9,9,0,0,0,0,0,9,9,0,0,0,0],
            [0,0,9,9,0,0,0,0,0,0,0,9,9,0,0,0],
            [0,0,9,9,0,0,0,0,0,0,0,9,9,0,0,0],
            [0,0,0,9,9,0,0,0,0,0,9,9,0,0,0,0],
            [0,0,0,0,9,9,9,9,9,9,9,0,0,0,0,0],
            [0,0,0,0,0,9,9,9,9,9,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
        ],
        
        domain_expansion: {
            background: [
                [10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10],
                [10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,10],
                [10,11,10,10,10,10,10,10,10,10,10,10,10,10,11,10],
                [10,11,10,11,11,11,11,11,11,11,11,11,11,10,11,10],
                [10,11,10,11,10,10,10,10,10,10,10,10,11,10,11,10],
                [10,11,10,11,10,11,11,11,11,11,11,10,11,10,11,10],
                [10,11,10,11,10,11,10,10,10,10,11,10,11,10,11,10],
                [10,11,10,11,10,11,10,11,11,10,11,10,11,10,11,10],
                [10,11,10,11,10,11,10,11,11,10,11,10,11,10,11,10],
                [10,11,10,11,10,11,10,10,10,10,11,10,11,10,11,10],
                [10,11,10,11,10,11,11,11,11,11,11,10,11,10,11,10],
                [10,11,10,11,10,10,10,10,10,10,10,10,11,10,11,10],
                [10,11,10,11,11,11,11,11,11,11,11,11,11,10,11,10],
                [10,11,10,10,10,10,10,10,10,10,10,10,10,10,11,10],
                [10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,10],
                [10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10]
            ],
            palette: [
                '#000000',  // 10: черный фон
                '#6600cc'   // 11: фиолетовый узор
            ]
        }
    },

    // Фоны
    backgrounds: {
        arena: [
            [12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12],
            [12,13,13,13,13,13,13,13,13,13,13,13,13,13,13,12],
            [12,13,14,14,14,14,14,14,14,14,14,14,14,14,13,12],
            [12,13,14,15,15,15,15,15,15,15,15,15,15,14,13,12],
            [12,13,14,15,16,16,16,16,16,16,16,16,15,14,13,12],
            [12,13,14,15,16,17,17,17,17,17,17,16,15,14,13,12],
            [12,13,14,15,16,17,18,18,18,18,17,16,15,14,13,12],
            [12,13,14,15,16,17,18,19,19,18,17,16,15,14,13,12],
            [12,13,14,15,16,17,18,19,19,18,17,16,15,14,13,12],
            [12,13,14,15,16,17,18,18,18,18,17,16,15,14,13,12],
            [12,13,14,15,16,17,17,17,17,17,17,16,15,14,13,12],
            [12,13,14,15,16,16,16,16,16,16,16,16,15,14,13,12],
            [12,13,14,15,15,15,15,15,15,15,15,15,15,14,13,12],
            [12,13,14,14,14,14,14,14,14,14,14,14,14,14,13,12],
            [12,13,13,13,13,13,13,13,13,13,13,13,13,13,13,12],
            [12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12]
        ],
        bgPalette: [
            '#0a0a0a',  // 12: черный фон
            '#1a1a2e',  // 13: темно-синий
            '#16213e',  // 14: синий
            '#0f3460',  // 15: голубой
            '#1e5f8b',  // 16: светло-голубой
            '#2a7fb8',  // 17: голубой 2
            '#3d9ae8',  // 18: ярко-голубой
            '#4ab5ff'   // 19: самый светлый голубой
        ]
    },

    // Метод для отрисовки пиксельного спрайта
    drawSprite(ctx, spriteData, x, y, scale = 2.5, flip = false) {
        const width = spriteData[0].length;
        const height = spriteData.length;
        const palette = spriteData.palette || this.yuji_young.palette;
        
        for (let row = 0; row < height; row++) {
            for (let col = 0; col < width; col++) {
                let pixelCol = flip ? width - 1 - col : col;
                const colorIndex = spriteData[row][pixelCol];
                
                if (colorIndex !== 0 && palette[colorIndex]) {
                    ctx.fillStyle = palette[colorIndex];
                    ctx.fillRect(
                        x + col * scale,
                        y + row * scale,
                        scale,
                        scale
                    );
                }
            }
        }
    },

    // Метод для отрисовки фона
    drawBackground(ctx, width, height) {
        const bg = this.backgrounds.arena;
        const palette = this.backgrounds.bgPalette;
        const tileSize = 32;
        
        for (let y = 0; y < height; y += tileSize) {
            for (let x = 0; x < width; x += tileSize) {
                const bgX = (x / tileSize) % bg[0].length;
                const bgY = (y / tileSize) % bg.length;
                const colorIndex = bg[bgY][bgX];
                
                if (palette[colorIndex]) {
                    ctx.fillStyle = palette[colorIndex];
                    ctx.fillRect(x, y, tileSize, tileSize);
                }
            }
        }
        
        // Платформа
        ctx.fillStyle = '#0f3460';
        ctx.fillRect(0, height - 100, width, 100);
        
        // Детали платформы
        ctx.fillStyle = '#1a1a2e';
        for (let x = 0; x < width; x += 50) {
            ctx.fillRect(x, height - 100, 25, 5);
        }
    },

    // Получить спрайт для состояния персонажа
    getCharacterSprite(characterId, state, frame = 0) {
        const character = this[characterId];
        if (!character) return this.yuji_young.idle;
        
        switch(state) {
            case 'idle':
                return character.idle || this.yuji_young.idle;
            case 'walk':
                return frame % 20 < 10 ? 
                    (character.walk1 || character.idle) : 
                    (character.walk2 || character.idle);
            case 'attack':
                return character.attack || this.yuji_young.attack;
            case 'hurt':
                return character.hurt || this.yuji_young.hurt;
            case 'jump':
                return character.jump || this.yuji_young.jump;
            case 'block':
                return character.block || this.yuji_young.block;
            default:
                return character.idle || this.yuji_young.idle;
        }
    },

    // Получить палитру персонажа
    getCharacterPalette(characterId) {
        return this[characterId]?.palette || this.yuji_young.palette;
    }
};